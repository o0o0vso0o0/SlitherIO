{"version":3,"sources":["GameScene.js"],"names":["o0","require","o0CC","o0Game","cc","Class","extends","Component","properties","canvas","camera","playGround","snakeNode","foodNode","playerSnake","playerName","playerSkin","playerInput","skinSet","snakeGeneratorTimer","maxSnake","maxFood","snakeIDcounter","foodIDcounter","leaderBoardNode","leaderBoardBackground","lengthLabel","lengthValueLabel","rankLabel","leaderBoardLabel","LRankLabels","LNameLabels","LScoreLabels","statisticalUpdateTimer","map","mapSize","respawnButton","returnButton","shareButton","generateAISnake","tryNextTiming","childrenCount","newAISnake","addSnake","name","node","skin","push","parseInt","length","Math","random","newSnakePosition","randomInCircle2","radius","head","x","y","snakeScript","snake","addScriptNode","gameScene","i","arguments","addComponent","onLoad","self","Node","addChild","Timer","setGroup","GroupIndex","UI","anchorX","anchorY","color","Color","fontSize","lineHeight","horizontalAlign","Label","HorizontalAlign","LEFT","verticalAlign","VerticalAlign","CENTER","newLabel","string","active","width","height","sdadsa","o0ClickEvent","log","sys","openURL","destroy","start","zIndex","update","dt","rank","children","getComponent","score","floor","clear","fillRect","fillColor","fill","sortChildren","isValid","sort","a","b","ac","bc","circle","close","foodPos","Vector2","multiply","bodyPos","body","lateUpdate","targetCameraPosition","parent","convertToNodeSpaceAR","convertToWorldSpace","v2","targetVector","minus","toLength","pow","currentScale","zoomRatio","targetScale","scaleX","scaleY","newScale","_onPreDestroy"],"mappings":"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","file":"GameScene.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Game","sourcesContent":["var o0 = require('o0');\r\nvar o0CC = require('o0CC');\r\nvar o0Game = require('o0Game');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        canvas:null,\r\n        camera:null,\r\n\r\n//        gameSceneNode:null,\r\n\r\n        playGround:null,\r\n        snakeNode:null,\r\n        //snakeBodyNode:null,\r\n        foodNode:null,\r\n        playerSnake:null,\r\n        playerName:'Player',\r\n        playerSkin:null,\r\n        playerInput:'',\r\n        skinSet:null,\r\n\r\n        snakeGeneratorTimer:null,\r\n\r\n        maxSnake: 10,\r\n        maxFood: 100,\r\n\r\n        snakeIDcounter: 0,\r\n        foodIDcounter: 0,\r\n\r\n        leaderBoardNode:null,\r\n        leaderBoardBackground:null,\r\n        lengthLabel:null,\r\n        lengthValueLabel:null,\r\n        rankLabel:null,\r\n        leaderBoardLabel:null,\r\n        LRankLabels:[],\r\n        LNameLabels:[],\r\n        LScoreLabels:[],\r\n        statisticalUpdateTimer:null,\r\n        map:null,\r\n        mapSize: 150,//直径\r\n\r\n        respawnButton:null,\r\n        returnButton:null,\r\n\r\n        shareButton:null,\r\n\r\n    },\r\n    generateAISnake:function(){\r\n        if(this.snakeGeneratorTimer.tryNextTiming()){\r\n            if(this.snakeNode.childrenCount < this.maxSnake && this.foodNode.childrenCount < this.maxFood){\r\n                var newAISnake = this.addSnake('Snake','LocalControl','SnakeAIInput');\r\n                //var control = newAISnake.node.getComponent('SnakePositionControl');\r\n\r\n                newAISnake.name = 'AI-'+newAISnake.node.name;\r\n                newAISnake.skin = [];\r\n                newAISnake.skin.push(this.skinSet[parseInt(this.skinSet.length*Math.random())]);\r\n\r\n                var newSnakePosition = o0.randomInCircle2(this.playGround.radius*2);\r\n                newAISnake.head.x = newSnakePosition.x;\r\n                newAISnake.head.y = newSnakePosition.y;\r\n                //var newSnakeRotation = Math.random() * 360;\r\n                //newAISnake.head.rotation = newSnakeRotation;\r\n                //control.setTargetVector(o0CC.vectorFromRotation(newSnakeRotation));\r\n            }\r\n        }\r\n    },\r\n    addSnake:function(snakeScript){\r\n        var snake = o0CC.addScriptNode(this.snakeNode,snakeScript,-1);\r\n        //snake.bodyParentNode = this.snakeBodyNode;\r\n        snake.gameScene = this;\r\n        snake.node.name = ''+this.snakeIDcounter++;\r\n        \r\n        for(var i=1;i<arguments.length;++i){\r\n            snake.head.addComponent(arguments[i]);\r\n        }/** */\r\n        //snake.head.addComponent(controlScript);\r\n        //snake.head.addComponent(inputScript);\r\n        return snake;\r\n    },\r\n    \r\n    onLoad: function () {\r\n        var self = this;\r\n        //cc.director.getCollisionManager().enabled = true;//开启碰撞检测\r\n        //this.gameSceneNode = new cc.Node();\r\n        //this.node.addChild(this.gameSceneNode,0);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        this.playGround = o0CC.addScriptNode(this.node,'PlayGround2',-100);  \r\n\r\n        this.snakeNode = new cc.Node();\r\n        this.node.addChild(this.snakeNode,4);\r\n        //this.snakeBodyNode = new cc.Node();\r\n        //this.node.addChild(this.snakeBodyNode,3);\r\n        this.foodNode = new cc.Node();\r\n        this.node.addChild(this.foodNode,2);\r\n      \r\n        this.snakeGeneratorTimer = new o0.Timer(1);\r\n\r\n        \r\n        \r\n        \r\n\r\n\r\n\r\n        \r\n/*\r\n        if(this.playerSnake.node.getComponent('Snake')!=null){\r\n            //cc.log('dasdad');\r\n            this.playerSnake.node.getComponent('Snake').test();\r\n        }/** */        \r\n        this.rankLabel = o0CC.addScriptNode(this.node,'cc.Label',10);\r\n        o0CC.setGroup(this.rankLabel,o0Game.GroupIndex.UI);\r\n        this.rankLabel.node.anchorX = 0;\r\n        this.rankLabel.node.anchorY = 0;/** */\r\n        this.rankLabel.node.color = new cc.Color(255,255,255);\r\n        //this.rankLabel.node.opacity = 0;无效\r\n        this.rankLabel.fontSize = 16;\r\n        this.rankLabel.lineHeight = 22;\r\n        this.rankLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n        this.rankLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;//TOP//CENTER//BOTTOM\r\n        \r\n        this.lengthLabel = o0CC.addScriptNode(this.node,'cc.Label',10);\r\n        o0CC.setGroup(this.lengthLabel,o0Game.GroupIndex.UI);\r\n        this.lengthLabel.node.anchorX = 0;\r\n        this.lengthLabel.node.anchorY = 0;/** */\r\n        this.lengthLabel.node.color = new cc.Color(255,255,255);\r\n        this.lengthLabel.fontSize = 16;\r\n        this.lengthLabel.lineHeight = 22;\r\n        this.lengthLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n        this.lengthLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n        \r\n        this.lengthValueLabel = o0CC.addScriptNode(this.node,'cc.Label',10);\r\n        o0CC.setGroup(this.lengthValueLabel,o0Game.GroupIndex.UI);\r\n        this.lengthValueLabel.node.anchorX = 0;\r\n        this.lengthValueLabel.node.anchorY = 0;/** */\r\n        this.lengthValueLabel.node.color = new cc.Color(255,255,255);\r\n        this.lengthValueLabel.fontSize = 26;\r\n        this.lengthValueLabel.lineHeight = 32;\r\n        this.lengthValueLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n        this.lengthValueLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n        \r\n\r\n        this.leaderBoardBackground = o0CC.addScriptNode(this.node,'cc.Graphics',10);\r\n        o0CC.setGroup(this.leaderBoardBackground,o0Game.GroupIndex.UI);\r\n        this.leaderBoardNode = this.leaderBoardBackground.node;\r\n\r\n        this.leaderBoardLabel = o0CC.addScriptNode(this.leaderBoardNode,'cc.Label',10);\r\n        this.leaderBoardLabel.node.anchorX = 1;\r\n        this.leaderBoardLabel.node.anchorY = 1;/** */\r\n        this.leaderBoardLabel.node.color = new cc.Color(255,255,255);\r\n        this.leaderBoardLabel.fontSize = 20;\r\n        this.leaderBoardLabel.lineHeight = 36;\r\n        this.leaderBoardLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n        this.leaderBoardLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n\r\n\r\n        for(var i = 0;i<10;++i){\r\n            var newLabel = o0CC.addScriptNode(this.leaderBoardNode,'cc.Label',10);\r\n            newLabel.node.anchorX = 1;\r\n            newLabel.node.anchorY = 1;/** */\r\n            newLabel.node.color = new cc.Color(255,255,255);\r\n            newLabel.fontSize = 16;\r\n            newLabel.lineHeight = 22;\r\n            newLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n            newLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n            this.LScoreLabels.push(newLabel);\r\n        }\r\n        for(var i = 0;i<10;++i){\r\n            var newLabel = o0CC.addScriptNode(this.leaderBoardNode,'cc.Label',10);\r\n            newLabel.node.anchorX = 0;\r\n            newLabel.node.anchorY = 1;/** */\r\n            newLabel.node.color = new cc.Color(255,255,255);\r\n            newLabel.fontSize = 16;\r\n            newLabel.lineHeight = 22;\r\n            newLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n            newLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n            this.LNameLabels.push(newLabel);\r\n        }\r\n        for(var i = 0;i<10;++i){\r\n            var newLabel = o0CC.addScriptNode(this.leaderBoardNode,'cc.Label',10);\r\n            newLabel.node.anchorX = 1;\r\n            newLabel.node.anchorY = 1;/** */\r\n            newLabel.node.color = new cc.Color(255,255,255);\r\n            newLabel.fontSize = 16;\r\n            newLabel.lineHeight = 22;\r\n            newLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n            newLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n            newLabel.string = '#'+(i+1);\r\n            this.LRankLabels.push(newLabel);\r\n        }\r\n        this.statisticalUpdateTimer = new o0.Timer(1);\r\n\r\n        this.map = o0CC.addScriptNode(this.node,'cc.Graphics',10);\r\n        o0CC.setGroup(this.map,o0Game.GroupIndex.UI);\r\n\r\n        \r\n        this.respawnButton = o0CC.addScriptNode(this.node,'o0CCButton',10);\r\n        o0CC.setGroup(this.respawnButton,o0Game.GroupIndex.UI);\r\n        this.respawnButton.node.active = false;\r\n        this.respawnButton.node.x = 0;\r\n        this.respawnButton.node.y = 0;\r\n        this.respawnButton.node.width = 200;\r\n        this.respawnButton.node.height = 40;/** */\r\n        this.respawnButton.name = 'Respawn';\r\n\r\n        var sdadsa = this;\r\n        \r\n        this.shareButton = o0CC.addScriptNode(this.node,'o0CCButton',10);\r\n        o0CC.setGroup(this.shareButton,o0Game.GroupIndex.UI);\r\n        this.shareButton.node.active = false;\r\n        this.shareButton.node.x = 0;\r\n        this.shareButton.node.y = 60;\r\n        this.shareButton.node.width = 200;\r\n        this.shareButton.node.height = 40;/** */\r\n        this.shareButton.name = 'Share';\r\n        this.shareButton.o0ClickEvent.push(function () {\r\n            cc.log(\"share\");\r\n            cc.log(sdadsa.rankLabel.string);\r\n            cc.log(sdadsa.lengthValueLabel.string);\r\n            cc.sys.openURL('twitter://post?text=' + \"I am in possion \" +sdadsa.rankLabel.string + \"with \" + sdadsa.lengthValueLabel.string + \"!!!!\")\r\n        });\r\n        \r\n        \r\n\r\n\r\n        this.returnButton = o0CC.addScriptNode(this.node,'o0CCButton',10);\r\n        o0CC.setGroup(this.returnButton,o0Game.GroupIndex.UI);\r\n        this.returnButton.node.active = false;\r\n        this.returnButton.node.x = 0;\r\n        this.returnButton.node.y = -60;\r\n        this.returnButton.node.width = 200;\r\n        this.returnButton.node.height = 40;/** */\r\n        this.returnButton.name = 'Return to Menu';\r\n        this.returnButton.o0ClickEvent.push(function () {\r\n            self.node.destroy();\r\n        });\r\n    },\r\n    start:function(){\r\n        var self = this;\r\n        this.camera.node.zIndex = 100;\r\n        this.playGround.canvas = this.canvas;\r\n        this.playGround.camera = this.camera;\r\n    },\r\n    \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    update: function (dt) {\r\n        if(this.playerSnake!= null && this.playerSnake.node!=null){\r\n            this.returnButton.node.active = false;\r\n            this.respawnButton.node.active = false;\r\n            this.shareButton.node.active = false;\r\n            \r\n        }else{\r\n            this.returnButton.node.active = true;\r\n            this.respawnButton.node.active = true;\r\n            this.shareButton.node.active = true;\r\n        }\r\n        \r\n        \r\n        \r\n        \r\n        //////////////////////////////\r\n        this.rankLabel.node.x = -this.canvas.node.width/2 + 5;\r\n        this.rankLabel.node.y = -this.canvas.node.height/2 + 5;// + this.rankLabel.lineHeight/2;\r\n        if(this.playerSnake!= null && this.playerSnake.node!=null){\r\n            var rank = 1;\r\n            for(var i = 0; i < this.snakeNode.childrenCount; ++i){\r\n                if(this.snakeNode.children[i].getComponent('Snake').score > this.playerSnake.score){\r\n                    rank++;\r\n                }\r\n            }\r\n            this.rankLabel.string = 'Your rank: ' + rank + ' of ' + this.snakeNode.childrenCount;\r\n        }\r\n\r\n        this.lengthLabel.node.x = this.rankLabel.node.x;\r\n        this.lengthLabel.node.y = this.rankLabel.node.y + this.rankLabel.fontSize;\r\n        this.lengthLabel.string = 'Your length: ';\r\n\r\n        this.lengthValueLabel.node.x = this.lengthLabel.node.x + 85;\r\n        this.lengthValueLabel.node.y = this.lengthLabel.node.y;\r\n        if(this.playerSnake!= null && this.playerSnake.node!=null){\r\n            this.lengthValueLabel.string = Math.floor(this.playerSnake.score);\r\n        }\r\n//////////////////////////////////// leaderBoard      \r\n        this.leaderBoardLabel.node.x = this.canvas.node.width/2 - 65;\r\n        this.leaderBoardLabel.node.y = this.canvas.node.height/2;\r\n        this.leaderBoardLabel.string = 'LeaderBoard'; \r\n\r\n        this.leaderBoardBackground.clear();\r\n        this.leaderBoardBackground.fillRect(this.canvas.node.width/2 - 235, this.canvas.node.height/2 - 205, 230, 170);\r\n        this.leaderBoardBackground.fillColor = new cc.Color(255,255,255,30);\r\n        this.leaderBoardBackground.fill();/** */\r\n\r\n        for(var i = 0;i<10;++i){\r\n            this.LScoreLabels[i].node.x = this.canvas.node.width/2 - 10;\r\n            this.LScoreLabels[i].node.y = this.leaderBoardLabel.node.y - this.leaderBoardLabel.lineHeight - i * this.LScoreLabels[i].fontSize;\r\n            this.LNameLabels[i].node.x = this.canvas.node.width/2 - 180;\r\n            this.LNameLabels[i].node.y = this.leaderBoardLabel.node.y - this.leaderBoardLabel.lineHeight - i * this.LScoreLabels[i].fontSize;\r\n            this.LRankLabels[i].node.x = this.canvas.node.width/2 - 200;\r\n            this.LRankLabels[i].node.y = this.leaderBoardLabel.node.y - this.leaderBoardLabel.lineHeight - i * this.LScoreLabels[i].fontSize;\r\n        }\r\n\r\n        this.map.node.x = (this.canvas.node.width/2 - this.mapSize/2 - 10);\r\n        this.map.node.y = -(this.canvas.node.height/2 - this.mapSize/2 - 10);\r\n\r\n        if(this.statisticalUpdateTimer.tryNextTiming()){\r\n            var sortChildren = [];\r\n            for(var i =0;i<this.snakeNode.childrenCount;++i){\r\n                if(this.snakeNode.children[i]!=null && this.snakeNode.children[i].isValid && this.snakeNode.children[i].getComponent('Snake') != null){\r\n                    sortChildren.push(this.snakeNode.children[i]);\r\n                }\r\n            }\r\n            sortChildren = sortChildren.sort(function(a, b){\r\n                var ac = a.getComponent('Snake');\r\n                var bc = b.getComponent('Snake');\r\n                if(ac == null){\r\n                    return bc.score;\r\n                }else if(bc == null){\r\n                    return ac.score;\r\n                }else if(ac == null && bc == null){\r\n                    return 0;\r\n                }\r\n                return bc.score - ac.score;\r\n            });\r\n            for(var i = 0;i<10;++i){\r\n                if(sortChildren[i]!=null){\r\n                    var snake = sortChildren[i].getComponent('Snake');\r\n                    if(snake!=null){\r\n                        this.LScoreLabels[i].string = Math.floor(snake.score);\r\n                    }\r\n                    this.LNameLabels[i].string = snake.name;\r\n    \r\n                    this.LScoreLabels[i].node.color = snake.color;\r\n                    this.LNameLabels[i].node.color = snake.color;\r\n                    this.LRankLabels[i].node.color = snake.color;\r\n                }else{\r\n                    this.LScoreLabels[i].string = '';\r\n                    this.LNameLabels[i].string = '';\r\n    \r\n                    this.LScoreLabels[i].node.color = new cc.Color(255,255,255);\r\n                    this.LNameLabels[i].node.color = new cc.Color(255,255,255);\r\n                    this.LRankLabels[i].node.color = new cc.Color(255,255,255);\r\n                }\r\n            }\r\n            \r\n            this.map.clear();\r\n            this.map.circle(0, 0, this.mapSize/2);\r\n            this.map.fillColor = new cc.Color(255,255,255,30);\r\n            this.map.fill();\r\n            if(this.foodNode.childrenCount!=0){\r\n                this.map.close();\r\n                for(var i = 0;i<this.foodNode.childrenCount;++i){\r\n                    var foodPos = new o0.Vector2(this.foodNode.children[i]).multiply(this.mapSize/1.1/2/this.playGround.radius);\r\n                    this.map.circle(foodPos.x, foodPos.y, 1);\r\n                }\r\n                this.map.fillColor = new cc.Color(255,255,255,255);\r\n                this.map.fill();/** */\r\n            }\r\n            if(this.playerSnake!= null && this.playerSnake.node!=null){\r\n                this.map.close();\r\n                for(var i = 0;i<1;++i){\r\n                    var bodyPos = new o0.Vector2(this.playerSnake.body[i]).multiply(this.mapSize/1.1/2/this.playGround.radius);\r\n                    this.map.circle(bodyPos.x, bodyPos.y, 5);\r\n                }\r\n                this.map.fillColor = new cc.Color(0,255,0,100);\r\n                this.map.fill();/** */\r\n            }\r\n        }\r\n///////////////////////////////////\r\n    },\r\n\r\n\r\n    lateUpdate: function (dt) {\r\n        if(this.playerSnake != null && this.playerSnake.node != null){\r\n            var targetCameraPosition = this.camera.node.parent.convertToNodeSpaceAR(this.playerSnake.head.convertToWorldSpace(cc.v2(0,0)));\r\n            if(this.camera.node.x!=targetCameraPosition.x || this.camera.node.y!=targetCameraPosition.y){\r\n                var targetVector = new o0.Vector2(targetCameraPosition).minus(new o0.Vector2(this.camera.node));\r\n                if(targetVector.length > 10){\r\n                    targetVector = targetVector.toLength(Math.pow(targetVector.length,0.6));\r\n                    //targetVector = targetVector.toLength(targetVector.length/10);\r\n                }\r\n                this.camera.node.x += targetVector.x;\r\n                this.camera.node.y += targetVector.y;\r\n            }\r\n\r\n            //var currentScale = 1/Math.pow(this.gameSceneNode.scaleX* this.gameSceneNode.scaleY,0.5);\r\n            var currentScale = 1/this.camera.zoomRatio;\r\n            var targetScale = Math.pow(this.playerSnake.head.scaleX* this.playerSnake.head.scaleY,0.5);\r\n            var newScale = currentScale * Math.pow(targetScale/currentScale,0.1);\r\n            this.camera.zoomRatio = 1/newScale;\r\n            /*\r\n            this.gameSceneNode.scaleX = 1/newScale;\r\n            this.gameSceneNode.scaleY = 1/newScale;/** */\r\n\r\n            \r\n\r\n            //this.camera.node.scaleX = this.playerSnake.node.scaleX;//抵消canvas scale的副作用\r\n            //this.camera.node.scaleY = this.playerSnake.node.scaleY;//抵消canvas scale的副作用\r\n        }//更新摄像机\r\n    },\r\n\r\n    _onPreDestroy:function(){\r\n        //cc.director.getCollisionManager().enabled = false;//碰撞检测\r\n        //this.node.active = false;\r\n    },\r\n});"]}