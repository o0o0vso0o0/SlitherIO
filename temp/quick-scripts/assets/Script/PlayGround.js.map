{"version":3,"sources":["PlayGround.js"],"names":["o0","require","o0CC","o0Game","cc","Class","extends","CircleCollider","properties","backgroundPattern","canvas","camera","onLoad","radius","displayRadius","setGroup","GroupIndex","PlayGround","background","node","addComponent","Graphics","clear","circle","fillColor","Color","fill","boundary","addGraphicNode","i","strokeColor","stroke","start","listener","event","EventListener","MOUSE","onMouseDown","onMouseUp","log","onMouseMove","onMouseScroll","eventManager","addListener","addBackgroundPattern","newPattern","addSpriteNode","push","scaleX","scaleY","rotation","update","dt","patternSize","rectPos","convertToWorldSpaceAR","v2","Vector2","convertToNodeSpaceAR","rectHalfSize","multiply","zoomRatio","minus","rectSize","patternPositions","arrangeInRect2","Rect","difference","length","x","y","scale","Math","sin"],"mappings":"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","file":"PlayGround.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["var o0 = require('o0');\r\nvar o0CC = require('o0CC');\r\nvar o0Game = require('o0Game');\r\n\r\ncc.Class({\r\n    extends: cc.CircleCollider,\r\n\r\n    properties: {\r\n        backgroundPattern:[],\r\n        canvas:null,\r\n        camera:null,\r\n    },\r\n\r\n    \r\n    onLoad: function () {\r\n        this.radius = 3000;\r\n        //this.tag = o0Game.CollisionTag.PlayGround;\r\n\r\n        var displayRadius = this.radius+40;\r\n\r\n        o0CC.setGroup(this,o0Game.GroupIndex.PlayGround);\r\n        var background = this.node.addComponent(cc.Graphics);\r\n        background.clear();\r\n        background.circle(0, 0, displayRadius*2);\r\n        background.fillColor = new cc.Color(155, 23, 33, 255);\r\n        background.fill();/** */\r\n        background.circle(0, 0, displayRadius);\r\n        background.fillColor = new cc.Color(16, 23, 33, 255);\r\n        background.fill();/** */\r\n\r\n        var boundary = o0CC.addGraphicNode(this.node,1);\r\n        boundary.clear();\r\n        for(var i = 0;i<100;++i){\r\n            boundary.circle(0, 0, displayRadius-100+i);\r\n            boundary.strokeColor = new cc.Color(16+i/2, 23, 33, i*2.5);\r\n            boundary.stroke();\r\n        }\r\n    },\r\n\r\n    start:function(){        \r\n        var listener = {\r\n            event: cc.EventListener.MOUSE,\r\n            onMouseDown: function (event) { \r\n            },\r\n            onMouseUp: function (event) {\r\n                cc.log();\r\n            },\r\n            onMouseMove: function (event) {\r\n                //self.mouseLocation = event.getLocation();\r\n            },\r\n            onMouseScroll: function (event) {\r\n            }\r\n        }\r\n        cc.eventManager.addListener(listener, this.node);\r\n    },\r\n    addBackgroundPattern(){\r\n        var newPattern = o0CC.addSpriteNode(this.node,'background',0).node;\r\n        this.backgroundPattern.push(newPattern);\r\n        newPattern.scaleX = 1;\r\n        newPattern.scaleY = 1;\r\n        newPattern.rotation = 10;\r\n    },\r\n    update: function (dt) {\r\n        var patternSize = 100;\r\n        //var rectPos = this.camera.node.convertToNodeSpaceAR(cc.v2(0,0));\r\n        var rectPos = this.camera.node.convertToWorldSpaceAR(cc.v2(0,0));\r\n        rectPos = new o0.Vector2(this.node.convertToNodeSpaceAR(rectPos));\r\n        var rectHalfSize= new o0.Vector2(this.node.convertToNodeSpaceAR(cc.v2(-patternSize,-patternSize))).multiply(-1/ this.camera.zoomRatio);//坐标换算不吃camera的radio\r\n        rectPos = rectPos.minus(rectHalfSize);\r\n        var rectSize = rectHalfSize.multiply(2);\r\n\r\n        var patternPositions = o0.arrangeInRect2(new o0.Rect(rectPos,rectSize),new o0.Vector2(0,0),new o0.Vector2(50,-9),new o0.Vector2(25,32.5));\r\n        var difference = this.backgroundPattern.length - patternPositions.length;\r\n        for(var i=0;i<-difference;++i){\r\n            this.addBackgroundPattern();\r\n        }\r\n        for(var i = 0;i<patternPositions.length;++i){\r\n            this.backgroundPattern[i].x = patternPositions[i].x;\r\n            this.backgroundPattern[i].y = patternPositions[i].y;\r\n            var scale = 1-(Math.sin(patternPositions[i].x)+Math.sin(patternPositions[i].y))*0.1;\r\n            this.backgroundPattern[i].scaleX = scale;\r\n            this.backgroundPattern[i].scaleY = scale;\r\n        }\r\n    },\r\n\r\n});"]}