{"version":3,"sources":["o0Game.js"],"names":["o0","require","o0CC","GroupIndex","Default","Food","Head","Body","PlayGround","UI","SnakeDirectionControl","script","speed","turningSpeed","normalSpeedRate","speedingSpeedRate","targetSpeedRate","targetVector","bodySpacingRate","bodySpacing","pulledScore","pullScoreRate","speedingScoreCost","minScore","addScore","updateScale","updateBodySpacing","updateSpeed","setTargetVector","Vector2","Math","pow","body","scaleX","scaleY","radius","sqrt","bool","vector","score","targetBodyLength","ceil","bodyLength","length","addBody","newFood","addScriptNode","foodParentNode","lastBody","foodPosition","randomInCircle2","node","x","y","pullScoreThreshold","pullFood","removeBody","i","j","moveDistance","mod","rotation","rotationFromVector","active","pullScore","destroy","dt","speedRate","targetRotation","head","nextRotation","moveVector","vectorFromRotation","updateSnakeBody","other","self","groupIndex","selfBody","destroySnake","_radius","bodyParentNode","_score","SnakeMouseControl","mouseLocation","listener","event","cc","EventListener","MOUSE","onMouseDown","setTargetSpeeding","onMouseUp","onMouseMove","getLocation","onMouseScroll","eventManager","addListener","localLocation","parent","convertToNodeSpaceAR","prototype","update","module","exports"],"mappings":"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","file":"o0Game.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\o0Lib","sourcesContent":["var o0 = require('o0');\r\nvar o0CC = require('o0CC');\r\n//for this game\r\n\r\nvar GroupIndex = {\r\n    Default : 0,\r\n    Food : 1,\r\n    Head : 2,\r\n    Body : 3,\r\n    PlayGround : 4,\r\n    UI : 5,\r\n}\r\n\r\nclass SnakeDirectionControl{\r\n    constructor(script) {\r\n        this.script = script;\r\n        this.speed = 1;\r\n        this.turningSpeed = 2;\r\n        this.normalSpeedRate = 1;\r\n        this.speedingSpeedRate = 3;\r\n        this.targetSpeedRate = 1;\r\n        this.targetVector = null;\r\n\r\n        this.bodySpacingRate = 0.3;\r\n        this.bodySpacing = 0;\r\n        \r\n        this.pulledScore = 0;\r\n        this.pullScoreRate = 0.7;//the rate means remove 1 score from snake, and 0.5 score will come out to be food.\r\n        this.speedingScoreCost = 0.02;//score cost per frame speeding\r\n        this.minScore = 5;     \r\n                   \r\n        this.addScore(10);\r\n        this.script.updateScale();\r\n        this.updateBodySpacing();\r\n        this.updateSpeed();\r\n        this.setTargetVector(new o0.Vector2(1,0));\r\n    }\r\n    get node(){\r\n        return this.script.node;\r\n    }\r\n    get radius(){\r\n        return this.script.radius;\r\n    }\r\n    set radius(_radius){\r\n        this.script.radius = _radius;\r\n    }\r\n\r\n    get bodyParentNode(){\r\n        return this.script.bodyParentNode;\r\n    }\r\n    get foodParentNode(){\r\n        return this.script.foodParentNode;\r\n    }\r\n    get body(){\r\n        return this.script.body;\r\n    }\r\n    get head(){\r\n        return this.script.head;\r\n    }\r\n    get score(){\r\n        return this.script.score;\r\n    }\r\n    set score(_score){\r\n        this.script.score = _score;\r\n    }\r\n\r\n    get pullScoreThreshold(){\r\n        return Math.pow(this.body[0].scaleX * this.body[0].scaleY,1) * 1.5;\r\n    }\r\n    get targetBodyLength(){\r\n        return this.score / Math.pow(this.body[0].scaleX * this.body[0].scaleY,1.5);\r\n    }\r\n    \r\n    updateSpeed(){\r\n        this.speed = 2 * Math.pow(this.body[0].scaleX * this.body[0].scaleY,1.0/3);\r\n    }\r\n    updateBodySpacing(){\r\n        this.bodySpacing = this.radius*2 * this.bodySpacingRate * Math.sqrt(this.body[0].scaleX * this.body[0].scaleY);\r\n    }\r\n    setTargetSpeeding(bool){\r\n        if(!bool)\r\n            this.targetSpeedRate = this.normalSpeedRate;\r\n        else\r\n            this.targetSpeedRate = this.speedingSpeedRate;\r\n    }\r\n    setTargetVector(vector){\r\n        this.targetVector = vector;\r\n    }\r\n    addScore(score) {\r\n        this.score += score;\r\n        this.script.updateScale();\r\n        this.updateBodySpacing();\r\n        this.updateSpeed();\r\n        var targetBodyLength = Math.ceil(this.bodyLength);\r\n        while(targetBodyLength > this.body.length){\r\n            this.script.addBody();\r\n        }\r\n    }\r\n    pullFood(score) {\r\n        var newFood = o0CC.addScriptNode(this.foodParentNode,'Food',-100);\r\n        var lastBody = this.body[this.body.length-1];\r\n        var foodPosition = o0.randomInCircle2(lastBody,(this.radius-newFood.radius)*2);\r\n        newFood.node.x = foodPosition.x;\r\n        newFood.node.y = foodPosition.y;\r\n        newFood.score = score;\r\n    }\r\n    pullScore(score){\r\n        this.score -= score;\r\n        this.script.updateScale();\r\n        this.updateBodySpacing();\r\n        this.updateSpeed();\r\n        this.pulledScore += score * this.pullScoreRate;\r\n        if(this.pulledScore >= this.pullScoreThreshold){\r\n            this.pulledScore -= this.pullScoreThreshold;\r\n            this.pullFood(this.pullScoreThreshold);\r\n        }\r\n        var targetBodyLength = Math.ceil(this.bodyLength);\r\n        while(targetBodyLength < this.body.length && this.body.length > 1){\r\n            this.script.removeBody();\r\n        }\r\n    }\r\n    updateSnakeBody(){\r\n        for(var i = 0, j = 1;j<this.body.length;++i, ++j){\r\n            var targetVector = new o0.Vector2(this.body[i].x-this.body[j].x,this.body[i].y-this.body[j].y);\r\n            var moveDistance = targetVector.length - this.bodySpacing;\r\n            if(j==this.body.length-1)\r\n                moveDistance += this.bodySpacing * (Math.ceil(this.bodyLength)-this.bodyLength)\r\n            targetVector = targetVector.mod;\r\n            this.body[j].rotation = o0CC.rotationFromVector(targetVector);\r\n            if(moveDistance <= 0)\r\n                continue;\r\n            this.body[j].x += targetVector.x * moveDistance;\r\n            this.body[j].y += targetVector.y * moveDistance;\r\n        }\r\n    }\r\n    destroySnake(){\r\n        this.node.active = false;//防止destory之前body再增长\r\n        while(this.score >= 1){\r\n            //cc.log(\"1\");\r\n            this.pullScore(1);\r\n        }\r\n        while(this.body.length > 1){\r\n            //cc.log(\"2\");\r\n            this.script.removeBody();\r\n        }\r\n        //cc.log(this.score);\r\n        this.node.destroy();\r\n        //this.destroy();\r\n    }\r\n\r\n    // called every frame\r\n    update (dt) {               \r\n        var speedRate;\r\n        if(this.score <= this.minScore)\r\n            speedRate = this.normalSpeedRate;\r\n        else{\r\n            speedRate = this.targetSpeedRate;\r\n            if(speedRate != this.normalSpeedRate && speedRate == this.speedingSpeedRate)\r\n                this.pullScore(this.speedingScoreCost);\r\n        }\r\n        for(var i = 0;i<speedRate;++i){\r\n            //移动蛇头\r\n            this.targetRotation = o0CC.rotationFromVector(this.targetVector);\r\n            this.head.rotation = o0CC.nextRotation(this.head.rotation,this.targetRotation,this.turningSpeed);\r\n            var moveVector = o0CC.vectorFromRotation(this.head.rotation);\r\n            this.body[0].x += moveVector.x*this.speed;\r\n            this.body[0].y += moveVector.y*this.speed;\r\n            \r\n            //////////////下面是移动蛇身\r\n            this.updateSnakeBody();\r\n        }\r\n    }\r\n    onCollisionEnter(other, self){\r\n        if(other.node.active == false || this.node.active == false){//貌似能解决两蛇对撞导致卡死的bug\r\n            return;\r\n        }\r\n        if(other.node.groupIndex == GroupIndex.Body){\r\n            //cc.log(\"aaaaaaaaaaaaaaaaaaa\");\r\n            var selfBody = false;\r\n            if(this.body.length > 1)\r\n                for(var i = 1; i<this.body.length;++i){\r\n                    if(other.node == this.body[i]){\r\n                        selfBody = true;\r\n                        break;\r\n                    }\r\n                }\r\n            if(selfBody == false){\r\n                //cc.log(\"dsadasd\");\r\n                this.destroySnake();\r\n            }\r\n        }\r\n        if(other.node.groupIndex == GroupIndex.Food){\r\n            this.addScore(other.score);\r\n            other.node.destroy();\r\n            //other.destroy();\r\n        }\r\n    }\r\n    onCollisionExit(other,self){\r\n        if(other.node.active == false || this.node.active == false){//貌似能解决两蛇对撞导致卡死的bug\r\n            return;\r\n        }\r\n        if(other.node.groupIndex == GroupIndex.PlayGround){\r\n            this.destroySnake();\r\n        }\r\n    }\r\n}\r\n\r\n\r\nclass SnakeMouseControl extends SnakeDirectionControl{\r\n    constructor(script) {\r\n        super(script);\r\n        //module.exports.snakeDirectionControl.prototype.getName.call(this,);\r\n        \r\n        var self = this;\r\n        this.mouseLocation = new o0.Vector2(1,0);\r\n        \r\n        var listener = {\r\n            event: cc.EventListener.MOUSE,\r\n            onMouseDown: function (event) {\r\n                self.setTargetSpeeding(true);   \r\n            },\r\n            onMouseUp: function (event) {\r\n                self.setTargetSpeeding(false);\r\n            },\r\n            onMouseMove: function (event) {\r\n                self.mouseLocation = event.getLocation();\r\n            },\r\n            onMouseScroll: function (event) {\r\n            }\r\n        }\r\n        cc.eventManager.addListener(listener, this.node);\r\n    }\r\n    update(dt) {\r\n        var localLocation = this.node.parent.convertToNodeSpaceAR(this.mouseLocation);\r\n        this.setTargetVector(new o0.Vector2(localLocation).mod);\r\n        \r\n        SnakeDirectionControl.prototype.update(dt);\r\n    }\r\n}/** */\r\n\r\nmodule.exports = {\r\n    GroupIndex,\r\n    //SnakeDirectionControl,\r\n    //SnakeMouseControl,\r\n};\r\n"]}