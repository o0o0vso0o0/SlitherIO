{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\SnakeInput/assets\\Script\\SnakeInput\\SnakeJoystickInput.js"],"names":["o0","require","o0CC","o0Game","cc","Class","extends","properties","touchLocation","moveLocation","speedingButton","onLoad","_super","self","addScriptNode","control","snake","node","setGroup","GroupIndex","UI","x","gameScene","canvas","width","y","height","name","on","Node","EventType","TOUCH_START","event","setTargetSpeeding","TOUCH_END","touchGraphic","Graphics","clear","circle","fillColor","Color","fill","moveGraphic","Vector2","listener","EventListener","TOUCH_ONE_BY_ONE","onTouchBegan","touch","getLocation","localTouchLocation","parent","convertToNodeSpaceAR","active","onTouchMoved","localMoveLocation","vector","minus","length","toLength","onTouchEnded","eventManager","addListener","start","dt","update","setTargetVector","mod"],"mappings":"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","file":"SnakeJoystickInput.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\SnakeInput","sourcesContent":["var o0 = require('o0');\r\nvar o0CC = require('o0CC');\r\nvar o0Game = require('o0Game');\r\n\r\ncc.Class({\r\n    extends: require('SnakeDirectionInput'),\r\n    properties: {\r\n        touchLocation: null,\r\n        moveLocation: null,\r\n        speedingButton:null,\r\n    },\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._super();\r\n        var self = this;\r\n        \r\n        this.speedingButton = o0CC.addScriptNode(this.control.snake.node,'o0CCButton',10);\r\n        o0CC.setGroup(this.speedingButton,o0Game.GroupIndex.UI);\r\n        this.speedingButton.node.x = this.control.snake.gameScene.canvas.node.width/2-150;\r\n        this.speedingButton.node.y = 0;\r\n        this.speedingButton.node.width = 80;\r\n        this.speedingButton.node.height = 80;/** */\r\n        this.speedingButton.name = 'Boost';\r\n        this.speedingButton.node.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n            self.setTargetSpeeding(true);\r\n        }, this);\r\n        this.speedingButton.node.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            self.setTargetSpeeding(false);\r\n        }, this);/** */\r\n\r\n\r\n\r\n        var touchGraphic = o0CC.addScriptNode(this.control.snake.node,cc.Graphics,9);\r\n        o0CC.setGroup(touchGraphic,o0Game.GroupIndex.UI);\r\n        //touchGraphic.groupIndex = o0Game.GroupIndex.UI;\r\n        touchGraphic.clear();\r\n        touchGraphic.circle(0, 0, 25);\r\n        touchGraphic.fillColor = new cc.Color(255,255,255,200);\r\n        touchGraphic.fill();\r\n        touchGraphic.node.x = -this.control.snake.gameScene.canvas.node.width/2+200;\r\n        touchGraphic.node.y = -this.control.snake.gameScene.canvas.node.height/2+200;\r\n        var moveGraphic = o0CC.addScriptNode(this.control.snake.node,cc.Graphics,10);\r\n        o0CC.setGroup(moveGraphic,o0Game.GroupIndex.UI);\r\n        //moveGraphic.groupIndex = o0Game.GroupIndex.UI;\r\n        moveGraphic.clear();\r\n        moveGraphic.circle(0, 0, 20);\r\n        moveGraphic.fillColor = new cc.Color(255,255,255,150);\r\n        moveGraphic.fill();\r\n        moveGraphic.node.x = -this.control.snake.gameScene.canvas.node.width/2+200;\r\n        moveGraphic.node.y = -this.control.snake.gameScene.canvas.node.height/2+200;\r\n\r\n        this.touchLocation = new o0.Vector2(1,0);\r\n        //TOUCH_ONE_BY_ONE\r\n        //TOUCH_ALL_AT_ONCE\r\n        var listener = {\r\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\r\n            onTouchBegan: function (touch, event) {\r\n                if(self.control == null){\r\n                    return false;\r\n                }\r\n                self.touchLocation = touch.getLocation();\r\n                var localTouchLocation = self.control.snake.node.parent.convertToNodeSpaceAR(self.touchLocation);\r\n                touchGraphic.node.active = true;\r\n                touchGraphic.node.x = localTouchLocation.x;\r\n                touchGraphic.node.y = localTouchLocation.y;\r\n                return true;\r\n            },\r\n            onTouchMoved: function (touch, event) {\r\n                if(self.control == null){\r\n                    return false;\r\n                }\r\n\r\n                self.moveLocation = touch.getLocation();\r\n                var localTouchLocation = self.control.snake.node.parent.convertToNodeSpaceAR(self.touchLocation);\r\n                var localMoveLocation = self.control.snake.node.parent.convertToNodeSpaceAR(self.moveLocation);\r\n                var vector = new o0.Vector2(localMoveLocation).minus(localTouchLocation);\r\n                if(vector.length > 35){\r\n                    vector = vector.toLength(35);\r\n                }\r\n                moveGraphic.node.active = true;\r\n                moveGraphic.node.x = touchGraphic.node.x + vector.x;\r\n                moveGraphic.node.y = touchGraphic.node.y + vector.y;\r\n                return true;\r\n            },\r\n            onTouchEnded: function (touch, event) {\r\n                self.touchLocation = null;\r\n                if(touchGraphic.node!=null){\r\n                    touchGraphic.node.active = false;\r\n                }\r\n                if(moveGraphic.node!=null){\r\n                    moveGraphic.node.active = false;\r\n                }\r\n                return true;\r\n            },\r\n        }\r\n        cc.eventManager.addListener(listener, this.node);\r\n    },\r\n    start: function (dt) {\r\n    },\r\n    update: function (dt) {\r\n        this._super();\r\n        if(this.touchLocation == null || this.moveLocation == null){\r\n            return;\r\n        }\r\n        var localTouchLocation = this.node.parent.convertToNodeSpaceAR(this.touchLocation);\r\n        var localMoveLocation = this.node.parent.convertToNodeSpaceAR(this.moveLocation);\r\n        this.setTargetVector(new o0.Vector2(localMoveLocation).minus(localTouchLocation).mod);\r\n    },/*\r\n    test:function(){\r\n        cc.log('mouse snake');\r\n    },/** */\r\n});"]}